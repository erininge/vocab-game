<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#ffffff" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="icon" href="icons/icon-192.png" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <link rel="stylesheet" href="styles.css?v=050">
  <title>Kat's Vocab Garden (PWA)</title>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo" aria-hidden="true">ðŸŒ¸</div>
      <div>
        <div class="title">Kat's Vocab Garden</div>
        <div class="subtitle" id="versionLine">PWA</div>
      </div>
    </div>
    <div class="topbar-actions">
      <button class="btn ghost" id="installBtn" hidden>Install</button>
    </div>
  </header>

  <main class="container">
    <section class="card" id="screenHome">
      <h1>Study setup</h1>

      <div class="grid">
        <label class="field">
          <span class="label">Category (JSON file)</span>
          <select id="levelSelect"></select>
          <span class="hint">Categories are discovered from <code>Vocabulary/</code>. File name becomes the category.</span>
        </label>

        <label class="field">
          <span class="label">Question mode</span>
          <select id="questionMode">
            <option value="mixed">Mixed (JPâ†’EN and ENâ†’JP)</option>
            <option value="jp2en">JP â†’ English</option>
            <option value="en2jp">English â†’ JP (kana/kanji accepted)</option>
            <option value="listening">Listening practice (JP â†’ EN)</option>
          </select>
        </label>

        <label class="field">
          <span class="label">Answer mode</span>
          <select id="answerMode">
            <option value="typing">Typing</option>
            <option value="multiple_choice">Multiple choice</option>
            <option value="mixed">Mixed (typing + multiple choice)</option>
          </select>
        </label>

        <label class="field">
          <span class="label">Practice mode</span>
          <select id="practiceMode">
            <option value="all">All items</option>
            <option value="starred">Starred only</option>
          </select>
        </label>

        <label class="field">
          <span class="label">Display mode (when prompt is JP)</span>
          <select id="displayMode">
            <option value="both">Kana + Kanji</option>
            <option value="kana">Kana only</option>
            <option value="kanji">Kanji only</option>
          </select>
        </label>

        <label class="field">
          <span class="label">Questions per quiz</span>
          <input id="qCount" type="number" min="5" max="200" step="1" value="20" />
        </label>

        <label class="field">
          <span class="label">Audio</span>
          <div class="row">
            <label class="checkbox">
              <input id="audioEnabled" type="checkbox" checked />
              <span>Audio enabled</span>
            </label>
          </div>
          <div class="row">
            <label class="field">
              <span class="label">Voice</span>
              <select id="audioVoice" aria-label="Audio voice"></select>
            </label>
          </div>
          <div class="row">
            <button class="btn ghost" id="testAudioBtn" type="button">Test audio</button>
          </div>
          <span class="hint">Put your audio pack in <code>Audio/</code> (and optional user recordings in <code>UserAudio/</code>) next to <code>index.html</code>. Pick a voice to match the folder name.</span>
        </label>
      </div>

      <div class="divider"></div>

      <h2>Lessons</h2>
      <p class="muted" id="lessonHelp">Loading lessonsâ€¦</p>
      <div class="lessonBox" id="lessonBox" aria-label="Lesson selection"></div>

      <div class="actions">
        <button class="btn" id="startBtn">Start</button>
        <button class="btn ghost" id="viewVocabBtn" type="button">View vocab</button>
      </div>
      <p class="muted" id="practiceHelp" role="status"></p>

      <details class="card-lite">
        <summary>How to add more vocab later</summary>
        <ol>
          <li>Drop a new JSON file into <code>Vocabulary/</code>.</li>
          <li>Name it however you want (e.g. <code>MyFood_vocab.json</code>). That file name becomes the category.</li>
          <li>Make sure it follows the same structure as the existing files (see <code>Vocabulary/N5_vocab.json</code>).</li>
          <li>Push to GitHub Pages. The app will auto-detect the new file via the GitHub API (public repos). If the API is blocked, update <code>Vocabulary/vocab-manifest.json</code>.</li>
        </ol>
      </details>
    </section>

    <section class="card" id="screenVocab" hidden>
      <h1>Selected vocab</h1>
      <p class="muted" id="vocabMeta"></p>
      <div class="vocabList" id="vocabList" aria-live="polite"></div>
      <p class="muted" id="vocabHelp" role="status"></p>
      <div class="actions">
        <button class="btn ghost" id="backFromVocabBtn">Back to setup</button>
      </div>
    </section>

    <section class="card" id="screenQuiz" hidden>
      <div class="quizHeader">
        <div>
          <div class="kicker" id="quizMeta"></div>
          <h1 id="promptLine">â€¦</h1>
          <div class="subprompt" id="subpromptLine"></div>
        </div>
        <div class="quizControls">
          <button class="btn ghost" id="playBtn" title="Play audio">ðŸ”Š</button>
          <button class="btn ghost starBtn" id="starBtn" title="Mark for review" aria-pressed="false">â˜†</button>
          <button class="btn ghost" id="quitBtn">Quit</button>
        </div>
      </div>

      <div class="answerArea" id="answerArea"></div>

      <div class="feedback" id="feedback" hidden></div>

      <div class="actions">
        <button class="btn" id="submitBtn">Check</button>
        <button class="btn ghost" id="nextBtn" disabled>Next</button>
      </div>
    </section>

    <section class="card" id="screenDone" hidden>
      <h1>Done!</h1>
      <p id="scoreLine"></p>
      <div class="actions">
        <button class="btn" id="backHomeBtn">Back to setup</button>
      </div>
    </section>
  </main>

  <footer class="footer">
    <span id="footerLine">â€”</span>
    <span id="selectionCount" class="footerMeta"></span>
  </footer>

  <script src="app.js?v=050"></script>
</body>
</html>
